// SPDX-FileCopyrightText: Â© 2019-2026 Nadim Kobeissi <nadim@symbolic.software>
// SPDX-License-Identifier: GPL-3.0-only

// Shamir secret sharing with multiple reconstruction paths.
// The secret is split among 3 parties; any 2 can reconstruct.
// Tests that leaking one share doesn't compromise the secret,
// but leaking two does.

attacker[active]

principal Dealer[
	generates secret
	s1, s2, s3 = SHAMIR_SPLIT(secret)
]

Dealer -> Alice: s1
Dealer -> Bob: s2
Dealer -> Carol: s3

// Alice leaks her share
principal Alice[
	leaks s1
]

// Bob and Carol reconstruct
principal Bob[]
principal Carol[]

Bob -> Carol: s2

principal Carol[
	reconstructed = SHAMIR_JOIN(s2, s3)
]

queries[
	confidentiality? secret
	confidentiality? reconstructed
	equivalence? secret, reconstructed
]
