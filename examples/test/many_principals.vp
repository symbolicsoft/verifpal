// SPDX-FileCopyrightText: Â© 2019-2026 Nadim Kobeissi <nadim@symbolic.software>
// SPDX-License-Identifier: GPL-3.0-only

// Six principals in a broadcast authentication scenario.
// A Server signs a message, everyone verifies.
// Tests scaling with many principals and many queries.

attacker[active]

principal Server[
	knows private sk
	gsk = G^sk
	generates payload, nonce
	sig = SIGN(sk, HASH(payload, nonce))
]

principal Alice[]
principal Bob[]
principal Carol[]
principal Damian[]
principal Eve[]

Server -> Alice: [gsk], payload, nonce, sig
Server -> Bob: [gsk], payload, nonce, sig
Server -> Carol: [gsk], payload, nonce, sig
Server -> Damian: [gsk], payload, nonce, sig
Server -> Eve: [gsk], payload, nonce, sig

principal Alice[
	_ = SIGNVERIF(gsk, HASH(payload, nonce), sig)?
]

principal Bob[
	_ = SIGNVERIF(gsk, HASH(payload, nonce), sig)?
]

principal Carol[
	_ = SIGNVERIF(gsk, HASH(payload, nonce), sig)?
]

principal Damian[
	_ = SIGNVERIF(gsk, HASH(payload, nonce), sig)?
]

principal Eve[
	_ = SIGNVERIF(gsk, HASH(payload, nonce), sig)?
]

queries[
	confidentiality? payload
	authentication? Server -> Alice: payload
	authentication? Server -> Bob: payload
	authentication? Server -> Carol: payload
	authentication? Server -> Damian: payload
	authentication? Server -> Eve: payload
	freshness? nonce
]
