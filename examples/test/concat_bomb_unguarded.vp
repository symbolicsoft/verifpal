// SPDX-FileCopyrightText: Â© 2019-2026 Nadim Kobeissi <nadim@symbolic.software>
// SPDX-License-Identifier: GPL-3.0-only

// concat_bomb variant: no checked ASSERT on Bob's side, so the MAC
// isn't verified. Confidentiality holds but authentication fails.

attacker[active]

principal Alice[
	knows private k
	generates a, b, c, d, e
	bundle = CONCAT(a, b, c, d, e)
	encrypted = ENC(k, bundle)
	tag = MAC(k, encrypted)
]

Alice -> Bob: encrypted, tag

principal Bob[
	knows private k
	_ = ASSERT(MAC(k, encrypted), tag)
	bundle_b = DEC(k, encrypted)
	a_b, b_b, c_b, d_b, e_b = SPLIT(bundle_b)
]

queries[
	confidentiality? a
	confidentiality? b
	confidentiality? c
	confidentiality? d
	confidentiality? e
	authentication? Alice -> Bob: encrypted
]
