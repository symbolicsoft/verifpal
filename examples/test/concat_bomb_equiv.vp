// SPDX-FileCopyrightText: Â© 2019-2026 Nadim Kobeissi <nadim@symbolic.software>
// SPDX-License-Identifier: GPL-3.0-only

// concat_bomb variant: tests that all 5 split values are equivalent to
// their originals, plus freshness of the generated values.

attacker[active]

principal Alice[
	knows private k
	generates a, b, c, d, e
	bundle = CONCAT(a, b, c, d, e)
	encrypted = ENC(k, bundle)
	tag = MAC(k, encrypted)
]

Alice -> Bob: encrypted, tag

principal Bob[
	knows private k
	_ = ASSERT(MAC(k, encrypted), tag)?
	bundle_b = DEC(k, encrypted)
	a_b, b_b, c_b, d_b, e_b = SPLIT(bundle_b)?
]

queries[
	equivalence? a, a_b
	equivalence? b, b_b
	equivalence? c, c_b
	equivalence? d, d_b
	equivalence? e, e_b
	freshness? a
]
